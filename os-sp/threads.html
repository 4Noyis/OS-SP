<html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"/><title>Threads (İplikler)</title>
<link rel="stylesheet" href="style/styles.css">
</head><body><article id="109da5a7-18f6-80c9-8b3a-c4bf005fbaf4" class="page sans"><header><h1 class="page-title">Threads (İplikler)</h1><p class="page-description"></p></header><div class="page-body"><p id="109da5a7-18f6-807d-96d1-e777e62788d8" class="">Geleneksel işletim sistemlerinde her prosesin kendine ait adres uzayı ve tek akış kontrolü vardır. Prosesler arası paylaşım pek çok ilişkili uygulama için çok önemlidir.</p><p id="109da5a7-18f6-8055-ad3e-d2440db14224" class="">Çok etkileşimli prosesler için bu paylaşım, durum paylaşımı karmaşıklığı, artan ölümcül kilitlenme riski, sürekli paylaşılanlara ulaşmak için harcanan zaman kaybı karşımıza çıkan başlıca problemlerdir. Bu nedenlerle aynı adres uzayında birden fazla akış kontrolüne gerek duyulması kaçınılmazdır.</p><figure class="block-color-gray_background callout" style="white-space:pre-wrap;display:flex" id="109da5a7-18f6-801b-adcd-d94707b76b75"><div style="width:100%"><p id="23fb3c05-b9da-4065-83d4-5f1341e4c730" class="">Threads (iplikler) aynı adres uzayında çalışan paralel hafif proseslerdir.</p></div></figure><p id="109da5a7-18f6-8066-a4e9-fdf15f3ebabf" class="">Prosesler arasında paylaşımda oluşan zorlukların çözümü için iplikler kullanılır. Aynı proses ortamında birden fazla işlem yürütme imkanı sağlarlar.</p><p id="109da5a7-18f6-80eb-8233-fb2621affbf4" class="">Günümüzde işletim sistemleri çoklu iplikli yapıdadır. Her biri çekirdekteki aygıtların yönetimi ve kesmelerin ele alınması gibi kendine özel işlemleri gerçekleştirir. </p><p id="106bf2cd-8438-486a-98af-dc53382dc7b8" class="">Linux ortamında pilikler adres uzayı, bellek, açık dosyalar, gibi tüm kaynakları, global değişkenleri, çocuk processleri, bekleyen sinyalleri, sinyal işleyicileri ve hesaplama bilgilerini paylaşırlar. Paylaşmadıkları ise her bir ipliğe özel olan program sayacı, saklayıcıları, yığınları ve durumlarıdır.</p><p id="109da5a7-18f6-8037-81e1-f1056872ff8c" class="">Windows ortamında ise çocuk prosesler hariç diğer tüm paylaşımlar mevcuttur. </p><blockquote id="d5b20f34-3e30-4f54-899b-b83439e0fa68" class="">Çoklu iplik yapısı programın bir bölümü bloke olsa ya da uzun bir işlem yürütüyor olsa bile çalışmaya olanak sağlar.</blockquote><figure id="109da5a7-18f6-803b-86f5-f8a7ad0fe8c5" class="image"><a href="threads/Screenshot_2024-09-21_at_17.14.09.png"><img style="width:707.984375px" src="threads/Screenshot_2024-09-21_at_17.14.09.png"/></a></figure><p id="109da5a7-18f6-8025-8ecc-c77b3602a631" class="">Her prosesin kendi içerisinde çalışan en az bir ipliği olabileceği gibi birden fazla ipliği de olabilir. Kod ve veri bölümlerinin paylaşılması bir uygulamanın ipliklerinin aynı adres uzayında birbirinden farklı işlem yapabilmelerini sağlar. Örneğin üç ayrı işlemi gerçekleştirecek 3 ayrı proses yerine tek proseste 3 iplikle de aynı işlemler yapılabilir.</p><p id="e67c7066-8a42-4c3f-87df-e1793764ddca" class="">Proseslerin oluşturulması ve bellek tahsisi maliyetli iken ipliklerin kaynakları paylaşması nedeniyle oluşturulmaları ve anahtarlama sırasında yüklenmeleri daha az maliyetli olmaktadır.</p><blockquote id="109da5a7-18f6-80fb-9bd7-d930c1c70e0a" class="">İplikler, prosesler gibi birbirlerinden bağımsız değillerdir. </blockquote><h3 id="109da5a7-18f6-80f6-a594-ed4b4f795841" class="">Ne zaman proses ne zaman thread kullanılmalı?</h3><p id="109da5a7-18f6-800e-ba7c-c946443e9e78" class="">İplikler, işlerin birbirine çok bağlı olduğu, birlikte yürütüldüğü ve paylaşıldığı durumlarda; prosesler ise işlerin birbirinden büyük oranda bağımsız olduğu durumlarda kullanılır. </p><p id="6730b247-c9c8-4564-b855-90201e3d33f6" class="">İplikler CPU’nun etkin bir şekilde kulanılmasını sağlar. Özellikle, çok işlemcili sistemlerde iplikler, tüm işlemci çekirdeklerinden istenilen şekilde faydalanmayı mümkün kılar.</p><hr id="109da5a7-18f6-800f-af3c-da7c6f454324"/><ul id="ff29aaf5-f45c-45d5-921c-3be0ed957fb9" class="bulleted-list"><li style="list-style-type:disc">İplik durumları, çalışır, askıda ve hazır olmak üzere proses durumları ile aynıdır.</li></ul><ul id="109da5a7-18f6-80c0-80f8-f505ea504238" class="bulleted-list"><li style="list-style-type:disc">Her ipliğin kendi yığını (stack) vardır.</li></ul><p id="611e9d05-cfb6-489f-b950-1eae1d2b0163" class="">Her iplik farklı yordam çağrıları yapabildiği gibi geri dönecekleri yerler farklı olduğu için ayrı yığın gerekmektedir. Prosese ait iplikler o prosesin verilerini paylaşırlar. Ancak, her iplik belirli verilerin kendisine özel kopyalarına ihtiyaç duyabilir. Böyle verilere ipliğe özel veriler <mark class="highlight-blue_background">(thread-local storage, TLS)</mark> denilmektedir.</p><ul id="109da5a7-18f6-8095-a7cf-fdf5acafac78" class="bulleted-list"><li style="list-style-type:disc">Her prosesin başlangıçta bir ipliği var olup, iplik kütüphane fonksiyonları ile yeni iplikler oluşturulur.</li></ul><ul id="109da5a7-18f6-8032-b58f-cf0084821c75" class="bulleted-list"><li style="list-style-type:disc">Bir proses için oluşturulan her thread, diğer threadlerle aynı adres uzayında çalışır. Bazı sistemlerde iplikler arası anne-çocuk hiyerarşik yapısı vardır; ancak çoğu sistemde tüm iplikler eşittir.<ul id="35974e41-9dac-4062-81cc-e5b6f85b8648" class="bulleted-list"><li style="list-style-type:circle">Windows ve Linux için iplikler eşittir ve çekirdek düzeyinde gerçekleştirilirler.</li></ul></li></ul><h1 id="109da5a7-18f6-8017-89b9-e02dd3adff04" class="">İpliklerin Avantajları ve Dezavantajları </h1><ul id="109da5a7-18f6-80bc-b3a3-d9fcedd0ff94" class="bulleted-list"><li style="list-style-type:disc">Bir proses içinde birden fazla işlem olabilir. Bazı işlemler bazen bloke olabildiğ için ipliklere bölmek performansı arttırır.</li></ul><ul id="49bf8acf-9f85-44b8-b8fa-2eac26fb653c" class="bulleted-list"><li style="list-style-type:disc">İpliklerin kaynak ihtiyacı az olduğu için oluşturulmaları ve yok edilmeleri proseslere göre kolaydır.</li></ul><ul id="109da5a7-18f6-802e-84ea-c91488550303" class="bulleted-list"><li style="list-style-type:disc">Tek işlemcili bir sistemde ipliklerin bazıları işlemci tabanlı işlemleri, bazıları ise Giriş/Çıkış işlemlerini yapıyorsa performans artar. Hepsi işlemci tabanlı ise ipliğin performans artışı olmayıp maliyet getirecektir.</li></ul><ul id="109da5a7-18f6-8096-afe6-d42b54a8d57f" class="bulleted-list"><li style="list-style-type:disc">İplikler çok işlemcili sistemlerde faydalıdır. Her işlemciden eş zamanlı olarak yararlanmayı sağlar.</li></ul><ul id="109da5a7-18f6-80d9-b324-e3b01683a4d7" class="bulleted-list"><li style="list-style-type:disc">İpliklerle bellek paylaşımı yapmak oldukça kolaydır.</li></ul><p id="28edf683-81f4-46fc-b751-b4a031217689" class="">Çoklu iplikli yapılar her ne kadar birden fazla proses oluşturmaya göre avantajlı olsa da dezavantajlı olduğu durumlar da vardır. </p><ul id="6536466f-eaf2-4238-bdc0-a8d00bc6f2cf" class="bulleted-list"><li style="list-style-type:disc">Bir ipiliğin oluşturulması için gerekli süre, gerçekleştireceği işlemin süresinden daha fazla olabilir. </li></ul><ul id="109da5a7-18f6-8040-a610-eb10ac4e8e39" class="bulleted-list"><li style="list-style-type:disc">Ayrıca her işlem için yeni bir iplik oluşturmak sistemde yük oluşturup ve eş zamanlı çalışmayı engelleyebilir. </li></ul><ul id="109da5a7-18f6-80a5-b243-e29a20f62516" class="bulleted-list"><li style="list-style-type:disc">Çok sayıda iplik sistem kaynaklarının tükenmesine neden olabilir. </li></ul><p id="f7d794b6-d3da-4a14-9a6a-8ee00ec06cf9" class="">Bu problemler için geliştirilen çözümlerden bir tanesi iplik havuzlarıdır. </p><h3 id="109da5a7-18f6-80ec-8d13-f43d04adaa43" class="">İplik Havuzları</h3><p id="109da5a7-18f6-8051-b8b8-fe71fc8353ff" class="">İplik havuzları proses başlangıcında belli bir sayıda ipliğin oluşturulmasına ve çalışmayı beklemesine dayanmaktadır. </p><p id="109da5a7-18f6-80a8-9b98-ceaf798b9856" class="">Yeni bir işlem yapılacağı zaman havuzda bekleyen iplik varsa uyandırılır ve işlemi gerçekleştirir. İşlem tamamlandığında havuzda yeni bir iş için bekler. Yeni bir iş gerçekleştirileceği zaman havuzda iş yapmak için bekleyen bir iplik yoksa sistem çalışan ipliklerden birinin işini bitirmesini bekler. </p><p id="109da5a7-18f6-8065-b93a-f4333bc401f6" class="">Gerçekleştirilecek işlemin mevcut iplikle yapılması yeni bir iplik oluşturulmasını beklemekten çok daha az maliyetlidir.</p><p id="109da5a7-18f6-8054-b3fa-eea89aacaaf1" class="">Havuzdaki iplik sayısı işlemci sayısına, fiziksel bellek büyüklüğüne veya eşzamanlı gerçekleştirilmesi gereken işlem sayısına göre belirlenebilir. </p><h1 id="109da5a7-18f6-8087-9d1e-e2604f4a2815" class="">İpliklerin Gerçeklenmesi </h1><p id="109da5a7-18f6-8099-991d-e6e374c90e6b" class="">İplikler 3 türlü gerçeklenir: Kullanıcı uzayında, çekirdek uzayında, hibrit yapıda. </p><h2 id="109da5a7-18f6-803b-ade3-d18dc6931a5d" class="">Kullanıcı Uzayında Gerçekleme</h2><figure id="109da5a7-18f6-8019-b5b6-c0d33e73f4db" class="image"><a href="threads/Screenshot_2024-09-22_at_00.03.57.png"><img style="width:624px" src="threads/Screenshot_2024-09-22_at_00.03.57.png"/></a></figure><ul id="109da5a7-18f6-8086-a8ad-e57c342f3428" class="bulleted-list"><li style="list-style-type:disc">Kullanıcı uzayında gerçeklendiğinde çekirdek, ipliklerden değil proseslerden haberdardır. Kullanıcı uzayında iplikler gerçekleşip iplik tablosu kullanıcı uzayında tutulur. </li></ul><ul id="109da5a7-18f6-8064-a58c-e03f59537bf2" class="bulleted-list"><li style="list-style-type:disc">Bu model, ipliklerin ayrı bir iş sıralama algoritmasına sahip olmasına olanak sağlar. Ayrıca çekirdekteki iplik tablosu yeri gereksinimi ortadan kaldırıp yerel rutinler kullanarak çekirdeğe yapılan çağrılardan daha hızlı işlem yapmayı sağlar.</li></ul><ul id="85dcef7a-5393-4030-8393-ada1f56677cb" class="bulleted-list"><li style="list-style-type:disc">Ancak herhangi bir iplik doğrudan bloke olan bir sistem çağrısı yapmamalıdır. Çünkü böyle bir durumda tüm iplikler bloke olur. </li></ul><ul id="109da5a7-18f6-809b-8b45-d45393022d73" class="bulleted-list"><li style="list-style-type:disc">Bu gerçeklemede ipliğin kendisi çalışmayı bırakmazsa diğer iplikler çalışmaz. Buna çözüm olarak, proses belirli aralıklarla saat kesmesi isteyebilir. Böylece iş sıralama algoritması kontrolü iplikten devralır. </li></ul><ul id="109da5a7-18f6-80bd-96fe-ed8e7a307857" class="bulleted-list"><li style="list-style-type:disc">Çok iplikli çalışma istendiği durumlarda sıkça bloke olan ve sistem çağrısı yapan iplikler olur. Bu durumda iplikleri çekirdek düzeyinde işlemek çekirdeğe çok yük getirmez.</li></ul><h2 id="109da5a7-18f6-80af-872c-f89172ad7778" class="">Çekirdek Uzayında Gerçekleme</h2><figure id="109da5a7-18f6-80b0-ab1d-eebc02256588" class="image"><a href="threads/Screenshot_2024-09-22_at_00.11.34.png"><img style="width:576px" src="threads/Screenshot_2024-09-22_at_00.11.34.png"/></a></figure><ul id="109da5a7-18f6-80fc-9f9d-c786782fb03a" class="bulleted-list"><li style="list-style-type:disc">Çekirdek uzayındaki modellemede çekirdek ipliklerden haberdardır. İplik tablosu çekirdekte olup, yeni iplik oluşturmak için çekirdeğe sistem çağrısı yapılır.</li></ul><ul id="109da5a7-18f6-800f-8e39-d8cdb50dc50c" class="bulleted-list"><li style="list-style-type:disc">İpliği bloke edebilecek tüm çağrılar da çekirdeğe yönetilcek bir sistem çağrısı gerektirir. Kullanıcı uzayında ipliklerin modellemesinde problem oluşturan bloke sistem çağrılarının yeniden yazılması gerekmez.</li></ul><ul id="109da5a7-18f6-802b-817f-d8c3349d22fc" class="bulleted-list"><li style="list-style-type:disc">Bu gerçeklemede sistem çağrısı yapmak maliyetlidir. Çok sık iplik oluşturma ve yok etme gibi işlemler varsa vakit kaybı çoktur.</li></ul><h2 id="109da5a7-18f6-80f6-818b-d617d88207f2" class="">Hibrit Yapıda Gerçekleme</h2><figure id="109da5a7-18f6-80d7-a557-ddb731975be3" class="image" style="text-align:left"><a href="threads/Screenshot_2024-09-22_at_00.29.00.png"><img style="width:480px" src="threads/Screenshot_2024-09-22_at_00.29.00.png"/></a></figure><ul id="109da5a7-18f6-80e5-b1b6-ef0f444ee07e" class="bulleted-list"><li style="list-style-type:disc">Kullanıcı ve çekirdek uzayının birlikte çalıştığı yapıdır.</li></ul><ul id="109da5a7-18f6-8070-b50d-f9f1f3160b65" class="bulleted-list"><li style="list-style-type:disc">Çekirdek sadece çekirdek düzeyi ipliklerden haberdardır.</li></ul><ul id="109da5a7-18f6-8030-9ff8-de786c5c383d" class="bulleted-list"><li style="list-style-type:disc">Bir çekirdek düzeyi iplik birden fazla kullanıcı ipliği sırasıyla çalıştırır. Diğer iplik işlemleri, kullanıcı düzeyi iplik işlemleri şeklindedir. </li></ul><h3 id="46eea759-af4b-41d5-a677-2cbff223168c" class="">Çoktan Çoğa Modeli</h3><figure id="109da5a7-18f6-802c-971d-ee8b89f1e752" class="image" style="text-align:left"><a href="threads/Screenshot_2024-09-22_at_00.30.19.png"><img style="width:432px" src="threads/Screenshot_2024-09-22_at_00.30.19.png"/></a></figure><p id="109da5a7-18f6-80ab-a5d6-c7e72b1f7b8b" class="">Bu modelde kullanıcı seviyesindeki iplikler daha az ya da aynı sayıda çekirdek seviyesi ipliğe dağıtılır. </p><p id="109da5a7-18f6-8054-82ef-eee61e25383c" class="">Kullanıcı istediği sayıda kullanıcı ipliği oluşturabilse de çekirdek, bir anda sadece bir çekirdek ipliğini sıralayabileceğinden tam paralellik sağlanmaz. Sadece ilgili çekirdek iplikleri çoklı işlemcide paralel olarak çalıştırılabilmektedir. Ayrıca, bir iplik bloke olacak sistem çağrısı yaptığında çekirdek başka bir ipliğin çalışmasını sağlar.  </p><h1 id="109da5a7-18f6-8073-aaab-db803a0cd44f" class="">İplik Sinyalleri</h1><p id="109da5a7-18f6-80ac-ab77-f0fd4b5335a1" class="">Çok iplikli prosesler sinyal aldıklarında yapabilecek işlemler şunlardır:</p><ul id="109da5a7-18f6-8025-8149-ef909c508f62" class="bulleted-list"><li style="list-style-type:disc">Sinyalin uygulandığı ipliğe sinyal ulaştırabilirler.</li></ul><ul id="109da5a7-18f6-8006-9ca2-f93ff4264744" class="bulleted-list"><li style="list-style-type:disc">Prosesin tüm ipliklerine sinyal iletilebilir.</li></ul><ul id="109da5a7-18f6-80bb-90d4-fa7fc271d731" class="bulleted-list"><li style="list-style-type:disc">Prosesin belirli ipliklerine sinyal iletilebilir.</li></ul><ul id="109da5a7-18f6-8024-bb5e-d044f2d4d366" class="bulleted-list"><li style="list-style-type:disc">Prosese gelen tüm sinyalleri almak üzere bir iplik atanabilir.</li></ul></div></article><span class="sans" style="font-size:14px;padding-top:2em"></span></body></html>